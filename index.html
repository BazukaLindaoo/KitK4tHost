<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KitK4t Host ‚Äî Script Hosting Platform</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=JetBrains+Mono:wght@300;400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
<style>
  :root {
    --bg: #050508;
    --surface: #0d0d14;
    --surface2: #13131f;
    --surface3: #1a1a2e;
    --border: rgba(120,120,255,0.12);
    --border-glow: rgba(100,100,255,0.3);
    --accent: #6c63ff;
    --accent2: #00d4aa;
    --accent3: #ff6b6b;
    --text: #e8e8f0;
    --text-muted: #8888aa;
    --text-dim: #55556a;
    --glow: 0 0 30px rgba(108,99,255,0.15);
    --font-display: 'Syne', sans-serif;
    --font-mono: 'JetBrains Mono', monospace;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  html { scroll-behavior: smooth; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: var(--font-mono);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* BACKGROUND EFFECTS */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background:
      radial-gradient(ellipse 80% 60% at 20% 10%, rgba(108,99,255,0.06) 0%, transparent 60%),
      radial-gradient(ellipse 60% 40% at 80% 80%, rgba(0,212,170,0.04) 0%, transparent 60%);
    pointer-events: none;
    z-index: 0;
  }

  /* GRID LINES */
  body::after {
    content: '';
    position: fixed;
    inset: 0;
    background-image:
      linear-gradient(rgba(108,99,255,0.03) 1px, transparent 1px),
      linear-gradient(90deg, rgba(108,99,255,0.03) 1px, transparent 1px);
    background-size: 60px 60px;
    pointer-events: none;
    z-index: 0;
  }

  .container { max-width: 1200px; margin: 0 auto; padding: 0 24px; position: relative; z-index: 1; }

  /* NAV */
  nav {
    position: fixed;
    top: 0; left: 0; right: 0;
    z-index: 100;
    background: rgba(5,5,8,0.85);
    backdrop-filter: blur(20px);
    border-bottom: 1px solid var(--border);
  }

  .nav-inner {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 24px;
    max-width: 1200px;
    margin: 0 auto;
  }

  .logo {
    display: flex;
    align-items: center;
    gap: 10px;
    text-decoration: none;
  }

  .logo-icon {
    width: 32px; height: 32px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
    font-weight: 800;
    color: white;
    font-family: var(--font-display);
  }

  .logo-text {
    font-family: var(--font-display);
    font-weight: 800;
    font-size: 18px;
    color: var(--text);
    letter-spacing: -0.5px;
  }

  .logo-text span { color: var(--accent); }

  .nav-links {
    display: flex;
    align-items: center;
    gap: 8px;
    list-style: none;
  }

  .nav-links a {
    color: var(--text-muted);
    text-decoration: none;
    font-size: 13px;
    padding: 6px 14px;
    border-radius: 6px;
    transition: all 0.2s;
    letter-spacing: 0.3px;
  }

  .nav-links a:hover { color: var(--text); background: var(--surface2); }

  .nav-cta {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  /* BUTTONS */
  .btn {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 8px 18px;
    border-radius: 8px;
    font-size: 13px;
    font-family: var(--font-mono);
    font-weight: 500;
    cursor: pointer;
    border: none;
    transition: all 0.2s;
    text-decoration: none;
    letter-spacing: 0.3px;
  }

  .btn-ghost {
    background: transparent;
    color: var(--text-muted);
    border: 1px solid var(--border);
  }
  .btn-ghost:hover { color: var(--text); border-color: var(--border-glow); }

  .btn-primary {
    background: var(--accent);
    color: white;
    box-shadow: 0 0 20px rgba(108,99,255,0.3);
  }
  .btn-primary:hover { background: #7c74ff; box-shadow: 0 0 30px rgba(108,99,255,0.5); transform: translateY(-1px); }

  .btn-success {
    background: var(--accent2);
    color: #050508;
    font-weight: 600;
  }
  .btn-success:hover { background: #00e8bb; transform: translateY(-1px); }

  .btn-danger {
    background: rgba(255,107,107,0.15);
    color: var(--accent3);
    border: 1px solid rgba(255,107,107,0.2);
  }
  .btn-danger:hover { background: rgba(255,107,107,0.25); }

  .btn-sm { padding: 5px 12px; font-size: 12px; }

  /* PAGES */
  .page { display: none; padding-top: 80px; min-height: 100vh; }
  .page.active { display: block; }

  /* ============ HERO ============ */
  #page-home {
    display: none;
    padding-top: 80px;
    min-height: 100vh;
  }
  #page-home.active { display: block; }

  .hero {
    padding: 100px 0 80px;
    text-align: center;
    position: relative;
  }

  .hero-badge {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    background: rgba(108,99,255,0.1);
    border: 1px solid rgba(108,99,255,0.25);
    border-radius: 100px;
    padding: 6px 16px;
    font-size: 12px;
    color: var(--accent);
    margin-bottom: 32px;
    letter-spacing: 0.5px;
  }

  .hero-badge::before {
    content: '';
    width: 6px; height: 6px;
    background: var(--accent2);
    border-radius: 50%;
    animation: pulse 2s ease-in-out infinite;
  }

  @keyframes pulse {
    0%,100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.5; transform: scale(0.8); }
  }

  .hero h1 {
    font-family: var(--font-display);
    font-size: clamp(42px, 7vw, 80px);
    font-weight: 800;
    line-height: 1.05;
    letter-spacing: -2px;
    margin-bottom: 24px;
    color: var(--text);
  }

  .hero h1 .highlight {
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .hero p {
    font-size: 16px;
    color: var(--text-muted);
    max-width: 500px;
    margin: 0 auto 40px;
    line-height: 1.7;
  }

  .hero-actions {
    display: flex;
    gap: 12px;
    justify-content: center;
    flex-wrap: wrap;
  }

  .hero-actions .btn { padding: 12px 28px; font-size: 14px; }

  /* STATS */
  .stats-bar {
    border-top: 1px solid var(--border);
    border-bottom: 1px solid var(--border);
    background: var(--surface);
    padding: 32px 0;
    margin: 40px 0;
  }

  .stats-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 0;
  }

  .stat-item {
    text-align: center;
    padding: 0 20px;
    border-right: 1px solid var(--border);
  }
  .stat-item:last-child { border-right: none; }

  .stat-number {
    font-family: var(--font-display);
    font-size: 32px;
    font-weight: 800;
    color: var(--text);
    letter-spacing: -1px;
  }

  .stat-label { font-size: 12px; color: var(--text-dim); margin-top: 4px; }

  /* FEATURES */
  .features { padding: 80px 0; }

  .section-header {
    text-align: center;
    margin-bottom: 60px;
  }

  .section-tag {
    font-size: 11px;
    color: var(--accent);
    letter-spacing: 2px;
    text-transform: uppercase;
    margin-bottom: 16px;
  }

  .section-title {
    font-family: var(--font-display);
    font-size: clamp(28px, 4vw, 42px);
    font-weight: 800;
    letter-spacing: -1px;
    color: var(--text);
    margin-bottom: 16px;
  }

  .section-sub {
    font-size: 14px;
    color: var(--text-muted);
    max-width: 460px;
    margin: 0 auto;
    line-height: 1.7;
  }

  .features-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 16px;
  }

  .feature-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 28px;
    transition: all 0.3s;
    position: relative;
    overflow: hidden;
  }

  .feature-card::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--accent), transparent);
    opacity: 0;
    transition: opacity 0.3s;
  }

  .feature-card:hover { border-color: var(--border-glow); transform: translateY(-4px); box-shadow: var(--glow); }
  .feature-card:hover::before { opacity: 1; }

  .feature-icon {
    width: 44px; height: 44px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    margin-bottom: 16px;
  }

  .feature-icon.purple { background: rgba(108,99,255,0.15); }
  .feature-icon.teal { background: rgba(0,212,170,0.15); }
  .feature-icon.red { background: rgba(255,107,107,0.15); }
  .feature-icon.yellow { background: rgba(255,200,50,0.15); }
  .feature-icon.blue { background: rgba(50,150,255,0.15); }
  .feature-icon.pink { background: rgba(255,100,200,0.15); }

  .feature-title {
    font-family: var(--font-display);
    font-size: 16px;
    font-weight: 700;
    margin-bottom: 8px;
    color: var(--text);
  }

  .feature-desc { font-size: 13px; color: var(--text-muted); line-height: 1.6; }

  /* ============ MODAL ============ */
  .modal-overlay {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(5,5,8,0.9);
    backdrop-filter: blur(8px);
    z-index: 200;
    align-items: center;
    justify-content: center;
    padding: 20px;
  }
  .modal-overlay.active { display: flex; }

  .modal {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 20px;
    padding: 40px;
    width: 100%;
    max-width: 440px;
    position: relative;
    animation: modalIn 0.25s ease;
  }

  @keyframes modalIn {
    from { opacity: 0; transform: scale(0.95) translateY(10px); }
    to { opacity: 1; transform: scale(1) translateY(0); }
  }

  .modal-close {
    position: absolute;
    top: 16px; right: 16px;
    background: var(--surface2);
    border: 1px solid var(--border);
    color: var(--text-muted);
    width: 32px; height: 32px;
    border-radius: 8px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    transition: all 0.2s;
  }
  .modal-close:hover { color: var(--text); background: var(--surface3); }

  .modal-title {
    font-family: var(--font-display);
    font-size: 24px;
    font-weight: 800;
    margin-bottom: 8px;
    letter-spacing: -0.5px;
  }

  .modal-sub { font-size: 13px; color: var(--text-muted); margin-bottom: 28px; }

  .form-group { margin-bottom: 16px; }

  .form-label {
    display: block;
    font-size: 12px;
    color: var(--text-muted);
    margin-bottom: 8px;
    letter-spacing: 0.3px;
  }

  .form-input {
    width: 100%;
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 11px 14px;
    font-size: 13px;
    font-family: var(--font-mono);
    color: var(--text);
    transition: all 0.2s;
    outline: none;
  }

  .form-input:focus { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(108,99,255,0.1); }
  .form-input::placeholder { color: var(--text-dim); }

  .form-submit {
    width: 100%;
    padding: 12px;
    font-size: 14px;
    margin-top: 8px;
  }

  .form-footer {
    text-align: center;
    margin-top: 20px;
    font-size: 13px;
    color: var(--text-muted);
  }

  .form-footer a {
    color: var(--accent);
    cursor: pointer;
    text-decoration: none;
  }

  .alert {
    padding: 12px 16px;
    border-radius: 10px;
    font-size: 13px;
    margin-bottom: 16px;
    display: none;
  }
  .alert.error { background: rgba(255,107,107,0.1); border: 1px solid rgba(255,107,107,0.2); color: #ff9999; }
  .alert.success { background: rgba(0,212,170,0.1); border: 1px solid rgba(0,212,170,0.2); color: var(--accent2); }
  .alert.active { display: block; }

  /* ============ DASHBOARD ============ */
  #page-dashboard { padding-top: 80px; }

  .dash-layout {
    display: grid;
    grid-template-columns: 240px 1fr;
    gap: 0;
    min-height: calc(100vh - 80px);
  }

  .dash-sidebar {
    background: var(--surface);
    border-right: 1px solid var(--border);
    padding: 24px 16px;
    position: sticky;
    top: 80px;
    height: calc(100vh - 80px);
    overflow-y: auto;
  }

  .sidebar-section {
    margin-bottom: 32px;
  }

  .sidebar-section-title {
    font-size: 10px;
    color: var(--text-dim);
    letter-spacing: 1.5px;
    text-transform: uppercase;
    padding: 0 12px;
    margin-bottom: 8px;
  }

  .sidebar-link {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px 12px;
    border-radius: 10px;
    color: var(--text-muted);
    font-size: 13px;
    cursor: pointer;
    transition: all 0.2s;
    margin-bottom: 2px;
    text-decoration: none;
  }
  .sidebar-link:hover { background: var(--surface2); color: var(--text); }
  .sidebar-link.active { background: rgba(108,99,255,0.15); color: var(--accent); }
  .sidebar-link .icon { font-size: 16px; width: 20px; text-align: center; }

  .dash-main { padding: 32px; }

  .dash-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 32px;
  }

  .dash-title {
    font-family: var(--font-display);
    font-size: 24px;
    font-weight: 800;
    letter-spacing: -0.5px;
  }

  .dash-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 16px;
    margin-bottom: 32px;
  }

  .dash-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 24px;
  }

  .dash-card-label { font-size: 12px; color: var(--text-muted); margin-bottom: 12px; }

  .dash-card-value {
    font-family: var(--font-display);
    font-size: 32px;
    font-weight: 800;
    color: var(--text);
    letter-spacing: -1px;
  }

  .dash-card-sub { font-size: 12px; color: var(--text-dim); margin-top: 6px; }

  /* TABLE */
  .table-wrap {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 16px;
    overflow: hidden;
    margin-bottom: 24px;
  }

  .table-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 20px 24px;
    border-bottom: 1px solid var(--border);
  }

  .table-title { font-family: var(--font-display); font-size: 16px; font-weight: 700; }

  table { width: 100%; border-collapse: collapse; }

  th {
    text-align: left;
    padding: 12px 24px;
    font-size: 11px;
    color: var(--text-dim);
    letter-spacing: 1px;
    text-transform: uppercase;
    background: var(--surface2);
    border-bottom: 1px solid var(--border);
  }

  td {
    padding: 14px 24px;
    font-size: 13px;
    color: var(--text-muted);
    border-bottom: 1px solid var(--border);
  }
  tr:last-child td { border-bottom: none; }
  tr:hover td { background: var(--surface2); }

  /* BADGES */
  .badge {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 3px 10px;
    border-radius: 100px;
    font-size: 11px;
    font-weight: 500;
  }
  .badge-green { background: rgba(0,212,170,0.1); color: var(--accent2); border: 1px solid rgba(0,212,170,0.2); }
  .badge-red { background: rgba(255,107,107,0.1); color: var(--accent3); border: 1px solid rgba(255,107,107,0.2); }
  .badge-purple { background: rgba(108,99,255,0.1); color: var(--accent); border: 1px solid rgba(108,99,255,0.2); }
  .badge-gray { background: var(--surface2); color: var(--text-dim); border: 1px solid var(--border); }

  /* SCRIPT EDITOR */
  .editor-wrap {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 16px;
    overflow: hidden;
    margin-bottom: 24px;
  }

  .editor-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 14px 20px;
    background: var(--surface2);
    border-bottom: 1px solid var(--border);
  }

  .editor-dots { display: flex; gap: 6px; }
  .editor-dot {
    width: 12px; height: 12px;
    border-radius: 50%;
  }
  .editor-dot.red { background: #ff5f57; }
  .editor-dot.yellow { background: #ffbd2e; }
  .editor-dot.green { background: #28c941; }

  .editor-filename { font-size: 12px; color: var(--text-dim); }

  .editor-actions { display: flex; gap: 8px; }

  .code-editor {
    width: 100%;
    min-height: 300px;
    background: transparent;
    border: none;
    padding: 20px;
    font-family: var(--font-mono);
    font-size: 13px;
    color: var(--text);
    resize: vertical;
    outline: none;
    line-height: 1.6;
  }

  /* ============ SCRIPTS PAGE ============ */
  .scripts-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 16px;
  }

  .script-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 24px;
    transition: all 0.3s;
    cursor: pointer;
  }

  .script-card:hover { border-color: var(--border-glow); transform: translateY(-2px); }

  .script-card-header {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    margin-bottom: 12px;
  }

  .script-name {
    font-family: var(--font-display);
    font-size: 16px;
    font-weight: 700;
    color: var(--text);
    margin-bottom: 4px;
  }

  .script-author { font-size: 12px; color: var(--text-dim); }

  .script-desc { font-size: 13px; color: var(--text-muted); line-height: 1.5; margin-bottom: 16px; }

  .script-footer {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding-top: 16px;
    border-top: 1px solid var(--border);
  }

  .script-meta { display: flex; gap: 16px; }
  .script-meta-item { font-size: 11px; color: var(--text-dim); display: flex; align-items: center; gap: 4px; }

  /* SEARCH BAR */
  .search-bar {
    display: flex;
    gap: 12px;
    margin-bottom: 28px;
    align-items: center;
  }

  .search-input-wrap {
    flex: 1;
    position: relative;
  }

  .search-icon {
    position: absolute;
    left: 14px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-dim);
    font-size: 16px;
  }

  .search-input {
    width: 100%;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 11px 14px 11px 40px;
    font-size: 13px;
    font-family: var(--font-mono);
    color: var(--text);
    outline: none;
    transition: all 0.2s;
  }
  .search-input:focus { border-color: var(--accent); }
  .search-input::placeholder { color: var(--text-dim); }

  /* ADMIN PANEL */
  .admin-badge {
    background: linear-gradient(135deg, #ff6b6b, #ff8e53);
    color: white;
    font-size: 10px;
    padding: 2px 8px;
    border-radius: 4px;
    font-weight: 700;
    letter-spacing: 0.5px;
    margin-left: 8px;
  }

  /* TABS */
  .tabs {
    display: flex;
    gap: 4px;
    margin-bottom: 28px;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 4px;
    width: fit-content;
  }

  .tab {
    padding: 8px 20px;
    border-radius: 8px;
    font-size: 13px;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 0.2s;
    border: none;
    background: none;
    font-family: var(--font-mono);
  }
  .tab.active { background: var(--accent); color: white; }
  .tab:hover:not(.active) { color: var(--text); }

  /* UPLOAD FORM */
  .upload-zone {
    border: 2px dashed var(--border);
    border-radius: 16px;
    padding: 48px;
    text-align: center;
    transition: all 0.2s;
    cursor: pointer;
    margin-bottom: 24px;
  }
  .upload-zone:hover { border-color: var(--accent); background: rgba(108,99,255,0.03); }
  .upload-zone-icon { font-size: 36px; margin-bottom: 12px; }
  .upload-zone-title { font-family: var(--font-display); font-size: 18px; font-weight: 700; margin-bottom: 8px; }
  .upload-zone-sub { font-size: 13px; color: var(--text-muted); }

  /* STATUS INDICATOR */
  .status-dot {
    width: 8px; height: 8px;
    border-radius: 50%;
    display: inline-block;
    margin-right: 6px;
  }
  .status-dot.online { background: var(--accent2); animation: pulse 2s infinite; }
  .status-dot.offline { background: var(--accent3); }

  /* FOOTER */
  footer {
    border-top: 1px solid var(--border);
    background: var(--surface);
    padding: 48px 0;
    margin-top: 80px;
  }

  .footer-grid {
    display: grid;
    grid-template-columns: 2fr 1fr 1fr 1fr;
    gap: 40px;
    margin-bottom: 48px;
  }

  .footer-brand p { font-size: 13px; color: var(--text-muted); line-height: 1.7; margin-top: 12px; max-width: 260px; }

  .footer-col-title {
    font-family: var(--font-display);
    font-size: 14px;
    font-weight: 700;
    margin-bottom: 16px;
    color: var(--text);
  }

  .footer-links { list-style: none; }
  .footer-links li { margin-bottom: 10px; }
  .footer-links a { font-size: 13px; color: var(--text-muted); text-decoration: none; cursor: pointer; transition: color 0.2s; }
  .footer-links a:hover { color: var(--text); }

  .footer-bottom {
    border-top: 1px solid var(--border);
    padding-top: 24px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    font-size: 12px;
    color: var(--text-dim);
  }

  /* NOTIFICATIONS */
  .toast-container {
    position: fixed;
    bottom: 24px;
    right: 24px;
    z-index: 9999;
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .toast {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 14px 18px;
    font-size: 13px;
    display: flex;
    align-items: center;
    gap: 10px;
    min-width: 280px;
    animation: toastIn 0.3s ease;
    box-shadow: 0 8px 32px rgba(0,0,0,0.4);
  }

  @keyframes toastIn {
    from { opacity: 0; transform: translateX(20px); }
    to { opacity: 1; transform: translateX(0); }
  }

  .toast.success { border-color: rgba(0,212,170,0.3); }
  .toast.error { border-color: rgba(255,107,107,0.3); }

  /* MAINTENANCE MODE */
  .maintenance-banner {
    background: linear-gradient(135deg, rgba(255,200,50,0.1), rgba(255,150,0,0.1));
    border: 1px solid rgba(255,200,50,0.3);
    border-radius: 10px;
    padding: 12px 20px;
    font-size: 13px;
    color: #ffcc33;
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 24px;
  }

  /* API KEY DISPLAY */
  .api-key-display {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 12px 16px;
    font-family: var(--font-mono);
    font-size: 12px;
    color: var(--accent2);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
    margin-top: 12px;
  }

  /* PROFILE */
  .profile-header {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 20px;
    padding: 32px;
    display: flex;
    align-items: center;
    gap: 24px;
    margin-bottom: 24px;
  }

  .profile-avatar {
    width: 72px; height: 72px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: var(--font-display);
    font-size: 28px;
    font-weight: 800;
    color: white;
    flex-shrink: 0;
  }

  .profile-info h2 {
    font-family: var(--font-display);
    font-size: 22px;
    font-weight: 800;
    letter-spacing: -0.5px;
  }

  .profile-info p { font-size: 13px; color: var(--text-muted); margin-top: 4px; }

  /* RESPONSIVE */
  @media (max-width: 900px) {
    .features-grid { grid-template-columns: repeat(2, 1fr); }
    .dash-layout { grid-template-columns: 1fr; }
    .dash-sidebar { display: none; }
    .stats-grid { grid-template-columns: repeat(2, 1fr); }
    .footer-grid { grid-template-columns: 1fr 1fr; }
    .dash-grid { grid-template-columns: repeat(2, 1fr); }
  }

  @media (max-width: 600px) {
    .features-grid { grid-template-columns: 1fr; }
    .stats-grid { grid-template-columns: repeat(2, 1fr); }
    .footer-grid { grid-template-columns: 1fr; }
    .dash-grid { grid-template-columns: 1fr; }
  }

  /* DASH SUB PAGES */
  .dash-subpage { display: none; }
  .dash-subpage.active { display: block; }

  /* COPY BUTTON */
  .copy-btn {
    background: none;
    border: none;
    cursor: pointer;
    color: var(--text-dim);
    font-size: 14px;
    padding: 4px;
    transition: color 0.2s;
  }
  .copy-btn:hover { color: var(--accent); }

  select.form-input { cursor: pointer; }

  .form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
  }

  /* LOG ITEM */
  .log-item {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    padding: 14px 0;
    border-bottom: 1px solid var(--border);
    font-size: 13px;
  }
  .log-item:last-child { border-bottom: none; }
  .log-time { color: var(--text-dim); font-size: 11px; min-width: 130px; }
  .log-type { }
  .log-msg { color: var(--text-muted); }
</style>
</head>
<body>

<!-- NAV -->
<nav>
  <div class="nav-inner">
    <a href="#" class="logo" onclick="showPage('home')">
      <div class="logo-icon">K</div>
      <span class="logo-text">KitK4t <span>Host</span></span>
    </a>
    <ul class="nav-links" id="nav-links-public">
      <li><a href="#" onclick="showPage('home')">In√≠cio</a></li>
      <li><a href="#" onclick="showPage('scripts')">Scripts</a></li>
      <li><a href="#" onclick="showPage('home'); scrollToFeatures()">Recursos</a></li>
    </ul>
    <ul class="nav-links" id="nav-links-auth" style="display:none">
      <li><a href="#" onclick="showDashPage('scripts')">Scripts</a></li>
      <li><a href="#" onclick="showDashPage('upload')">Upload</a></li>
      <li><a href="#" onclick="showDashPage('logs')">Logs</a></li>
      <li id="admin-nav-link" style="display:none"><a href="#" onclick="showDashPage('admin')">Admin <span class="admin-badge">ADMIN</span></a></li>
    </ul>
    <div class="nav-cta" id="nav-cta-public">
      <button class="btn btn-ghost" onclick="openModal('login')">Entrar</button>
      <button class="btn btn-primary" onclick="openModal('register')">Criar Conta</button>
    </div>
    <div class="nav-cta" id="nav-cta-auth" style="display:none">
      <span style="font-size:13px;color:var(--text-muted)" id="nav-username"></span>
      <button class="btn btn-ghost btn-sm" onclick="showPage('dashboard')">Dashboard</button>
      <button class="btn btn-danger btn-sm" onclick="logout()">Sair</button>
    </div>
  </div>
</nav>

<!-- TOAST CONTAINER -->
<div class="toast-container" id="toast-container"></div>

<!-- ============ HOME PAGE ============ -->
<div id="page-home" class="page active">
  <!-- HERO -->
  <div class="hero">
    <div class="container">
      <div class="hero-badge">üê± KitK4t Host ¬∑ 100% Gratuito ¬∑ Seguro</div>
      <h1>A melhor plataforma de<br><span class="highlight">scripts Luau</span><br>do Brasil</h1>
      <p>Hospede, compartilhe e gerencie seus scripts Roblox com seguran√ßa de n√≠vel enterprise ‚Äî completamente gratuito, para sempre.</p>
      <div class="hero-actions">
        <button class="btn btn-primary" onclick="openModal('register')">
          ‚ö° Come√ßar Gr√°tis
        </button>
        <button class="btn btn-ghost" onclick="showPage('scripts')">
          üìÇ Ver Scripts
        </button>
      </div>
    </div>
  </div>

  <!-- STATS -->
  <div class="stats-bar">
    <div class="container">
      <div class="stats-grid">
        <div class="stat-item">
          <div class="stat-number" id="stat-users">1,247</div>
          <div class="stat-label">Usu√°rios Registrados</div>
        </div>
        <div class="stat-item">
          <div class="stat-number" id="stat-scripts">4,891</div>
          <div class="stat-label">Scripts Hospedados</div>
        </div>
        <div class="stat-item">
          <div class="stat-number" id="stat-downloads">38.2k</div>
          <div class="stat-label">Downloads Totais</div>
        </div>
        <div class="stat-item">
          <div class="stat-number">99.9%</div>
          <div class="stat-label">Uptime Garantido</div>
        </div>
      </div>
    </div>
  </div>

  <!-- FEATURES -->
  <div class="features" id="features">
    <div class="container">
      <div class="section-header">
        <div class="section-tag">// recursos</div>
        <h2 class="section-title">Tudo que voc√™ precisa,<br>sem custo nenhum</h2>
        <p class="section-sub">Criado para a comunidade Roblox com foco absoluto em seguran√ßa e qualidade.</p>
      </div>
      <div class="features-grid">
        <div class="feature-card">
          <div class="feature-icon purple">üõ°Ô∏è</div>
          <h3 class="feature-title">Prote√ß√£o DDoS & DoS</h3>
          <p class="feature-desc">Rate limiting por IP, WAF embutido e prote√ß√£o multicamada contra ataques de nega√ß√£o de servi√ßo.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon teal">‚úèÔ∏è</div>
          <h3 class="feature-title">Editor Embutido</h3>
          <p class="feature-desc">Editor com syntax highlighting para Luau, sistema de vers√µes e preview em tempo real.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon red">üîë</div>
          <h3 class="feature-title">Sistema de Chaves API</h3>
          <p class="feature-desc">Proteja seus scripts com chaves √∫nicas, controle acesso e revogue permiss√µes a qualquer momento.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon yellow">üîí</div>
          <h3 class="feature-title">Privacidade Total</h3>
          <p class="feature-desc">Scripts p√∫blicos ou privados, com sistema granular de permiss√µes e controle de acesso.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon blue">üìä</div>
          <h3 class="feature-title">Dashboard Admin</h3>
          <p class="feature-desc">Painel completo com monitoramento de usu√°rios, scripts, IPs suspeitos e estat√≠sticas em tempo real.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon pink">üì°</div>
          <h3 class="feature-title">Webhooks Discord</h3>
          <p class="feature-desc">Logs autom√°ticos no Discord para registro, login, uploads e atividades suspeitas, em tempo real.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- FOOTER -->
  <footer>
    <div class="container">
      <div class="footer-grid">
        <div class="footer-brand">
          <div class="logo">
            <div class="logo-icon">K</div>
            <span class="logo-text">KitK4t <span>Host</span></span>
          </div>
          <p>KitK4t Host √© a plataforma gratuita de hospedagem de scripts Luau para a comunidade Roblox. Seguro, r√°pido e sempre de gra√ßa.</p>
        </div>
        <div>
          <h4 class="footer-col-title">Plataforma</h4>
          <ul class="footer-links">
            <li><a onclick="showPage('scripts')">Scripts P√∫blicos</a></li>
            <li><a onclick="openModal('register')">Criar Conta</a></li>
            <li><a onclick="openModal('login')">Entrar</a></li>
          </ul>
        </div>
        <div>
          <h4 class="footer-col-title">Recursos</h4>
          <ul class="footer-links">
            <li><a>API Docs</a></li>
            <li><a>Changelog</a></li>
            <li><a>Status</a></li>
          </ul>
        </div>
        <div>
          <h4 class="footer-col-title">Legal</h4>
          <ul class="footer-links">
            <li><a>Termos de Uso</a></li>
            <li><a>Privacidade</a></li>
            <li><a>Blacklist</a></li>
          </ul>
        </div>
      </div>
      <div class="footer-bottom">
        <span>¬© 2024 KitK4t Host ‚Äî Todos os direitos reservados</span>
        <span><span class="status-dot online"></span>Todos os sistemas operacionais</span>
      </div>
    </div>
  </footer>
</div>

<!-- ============ SCRIPTS PAGE ============ -->
<div id="page-scripts" class="page">
  <div class="container" style="padding-top: 40px;">
    <div class="dash-header">
      <div>
        <div class="section-tag">// scripts p√∫blicos</div>
        <h1 class="dash-title">Explorar Scripts</h1>
      </div>
      <button class="btn btn-primary" onclick="openModal('register')">+ Upload Script</button>
    </div>

    <div class="search-bar">
      <div class="search-input-wrap">
        <span class="search-icon">üîç</span>
        <input type="text" class="search-input" placeholder="Buscar scripts por nome, categoria..." id="script-search" oninput="filterScripts()">
      </div>
      <select class="form-input" style="width:160px" id="script-filter" onchange="filterScripts()">
        <option value="all">Todos</option>
        <option value="game">Game</option>
        <option value="utility">Utilit√°rio</option>
        <option value="ui">UI</option>
        <option value="admin">Admin</option>
      </select>
    </div>

    <div class="scripts-grid" id="public-scripts-grid">
      <!-- Scripts will be rendered here -->
    </div>
  </div>
</div>

<!-- ============ DASHBOARD PAGE ============ -->
<div id="page-dashboard" class="page">
  <div class="dash-layout">
    <aside class="dash-sidebar">
      <div class="sidebar-section">
        <div class="sidebar-section-title">Principal</div>
        <a class="sidebar-link active" onclick="showDashPage('overview')" id="slink-overview">
          <span class="icon">üìä</span> Vis√£o Geral
        </a>
        <a class="sidebar-link" onclick="showDashPage('scripts')" id="slink-scripts">
          <span class="icon">üìÇ</span> Meus Scripts
        </a>
        <a class="sidebar-link" onclick="showDashPage('upload')" id="slink-upload">
          <span class="icon">‚¨ÜÔ∏è</span> Upload
        </a>
        <a class="sidebar-link" onclick="showDashPage('profile')" id="slink-profile">
          <span class="icon">üë§</span> Perfil
        </a>
      </div>
      <div class="sidebar-section">
        <div class="sidebar-section-title">Seguran√ßa</div>
        <a class="sidebar-link" onclick="showDashPage('logs')" id="slink-logs">
          <span class="icon">üìã</span> Meus Logs
        </a>
        <a class="sidebar-link" onclick="showDashPage('apikeys')" id="slink-apikeys">
          <span class="icon">üîë</span> Chaves API
        </a>
      </div>
      <div class="sidebar-section" id="admin-sidebar-section" style="display:none">
        <div class="sidebar-section-title">Administra√ß√£o</div>
        <a class="sidebar-link" onclick="showDashPage('admin')" id="slink-admin">
          <span class="icon">‚öôÔ∏è</span> Admin Panel <span class="admin-badge">ADMIN</span>
        </a>
      </div>
      <div style="padding: 12px; margin-top: auto;">
        <div style="font-size:11px; color: var(--text-dim); padding: 12px; background: var(--surface2); border-radius: 10px;">
          <div><span class="status-dot online"></span>Servidor online</div>
          <div style="margin-top: 6px; color: var(--text-dim)">Uptime: 99.9%</div>
        </div>
      </div>
    </aside>

    <main class="dash-main">
      <!-- OVERVIEW -->
      <div class="dash-subpage active" id="dash-overview">
        <div class="dash-header">
          <div>
            <h1 class="dash-title">Vis√£o Geral</h1>
            <p style="font-size:13px;color:var(--text-muted);margin-top:4px">Bem-vindo de volta, <span id="dash-username" style="color:var(--accent)"></span></p>
          </div>
        </div>
        <div class="dash-grid">
          <div class="dash-card">
            <div class="dash-card-label">üìÇ Scripts</div>
            <div class="dash-card-value" id="my-script-count">0</div>
            <div class="dash-card-sub">scripts hospedados</div>
          </div>
          <div class="dash-card">
            <div class="dash-card-label">‚¨áÔ∏è Downloads</div>
            <div class="dash-card-value" id="my-downloads">0</div>
            <div class="dash-card-sub">total de downloads</div>
          </div>
          <div class="dash-card">
            <div class="dash-card-label">üîë Chaves API</div>
            <div class="dash-card-value" id="my-keys">0</div>
            <div class="dash-card-sub">chaves ativas</div>
          </div>
        </div>

        <div class="table-wrap">
          <div class="table-header">
            <span class="table-title">Atividade Recente</span>
          </div>
          <div style="padding: 20px 24px;" id="dash-activity">
            <div class="log-item">
              <span class="log-time">agora mesmo</span>
              <span class="badge badge-green">Login</span>
              <span class="log-msg">Login realizado com sucesso</span>
            </div>
          </div>
        </div>
      </div>

      <!-- MY SCRIPTS -->
      <div class="dash-subpage" id="dash-scripts">
        <div class="dash-header">
          <h1 class="dash-title">Meus Scripts</h1>
          <button class="btn btn-primary" onclick="showDashPage('upload')">+ Novo Script</button>
        </div>
        <div class="table-wrap">
          <div class="table-header">
            <span class="table-title">Scripts</span>
          </div>
          <table>
            <thead>
              <tr>
                <th>Nome</th>
                <th>Visibilidade</th>
                <th>Vers√£o</th>
                <th>Downloads</th>
                <th>Data</th>
                <th>A√ß√µes</th>
              </tr>
            </thead>
            <tbody id="my-scripts-table">
              <tr>
                <td colspan="6" style="text-align:center;color:var(--text-dim);padding:32px">
                  Nenhum script ainda. <a href="#" onclick="showDashPage('upload')" style="color:var(--accent)">Fa√ßa upload agora</a>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- UPLOAD -->
      <div class="dash-subpage" id="dash-upload">
        <div class="dash-header">
          <h1 class="dash-title">Upload de Script</h1>
        </div>

        <div class="editor-wrap">
          <div class="editor-header">
            <div class="editor-dots">
              <div class="editor-dot red"></div>
              <div class="editor-dot yellow"></div>
              <div class="editor-dot green"></div>
            </div>
            <span class="editor-filename" id="editor-filename">script.luau</span>
            <div class="editor-actions">
              <button class="btn btn-ghost btn-sm" onclick="clearEditor()">Limpar</button>
              <button class="btn btn-ghost btn-sm" onclick="formatCode()">Formatar</button>
            </div>
          </div>
          <textarea class="code-editor" id="code-editor" placeholder="-- Seu script Luau aqui
local Players = game:GetService('Players')
local player = Players.LocalPlayer

-- Exemplo de script
print('Hello, KitK4t Host!')"></textarea>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
          <div>
            <div class="form-group">
              <label class="form-label">NOME DO SCRIPT</label>
              <input type="text" class="form-input" placeholder="Meu Script Incr√≠vel" id="upload-name">
            </div>
            <div class="form-group">
              <label class="form-label">DESCRI√á√ÉO</label>
              <textarea class="form-input" rows="3" placeholder="Descreva o que o script faz..." id="upload-desc" style="resize:none"></textarea>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label class="form-label">CATEGORIA</label>
                <select class="form-input" id="upload-cat">
                  <option value="game">Game</option>
                  <option value="utility">Utilit√°rio</option>
                  <option value="ui">UI</option>
                  <option value="admin">Admin</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">VISIBILIDADE</label>
                <select class="form-input" id="upload-visibility">
                  <option value="public">P√∫blico</option>
                  <option value="private">Privado</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">PROTEGER COM CHAVE API?</label>
              <select class="form-input" id="upload-key-protect">
                <option value="no">N√£o</option>
                <option value="yes">Sim ‚Äî requer chave para acessar</option>
              </select>
            </div>
            <button class="btn btn-primary" style="width:100%;padding:12px" onclick="uploadScript()">
              ‚¨ÜÔ∏è Fazer Upload
            </button>
          </div>
          <div>
            <div class="dash-card" style="margin-bottom:16px">
              <div class="dash-card-label">üìã Diretrizes</div>
              <div style="font-size:13px;color:var(--text-muted);line-height:1.7;margin-top:8px">
                ‚úì Apenas scripts Luau v√°lidos<br>
                ‚úì M√°ximo 1MB por script<br>
                ‚úì Sem c√≥digo malicioso<br>
                ‚úì Respeite os ToS do Roblox<br>
                ‚úì Scripts blacklistados s√£o removidos<br>
                ‚úì Reincid√™ncias resultam em ban
              </div>
            </div>
            <div class="dash-card">
              <div class="dash-card-label">üîí Seguran√ßa</div>
              <div style="font-size:13px;color:var(--text-muted);line-height:1.7;margin-top:8px">
                Todos os uploads s√£o escaneados contra nossa blacklist e validados antes de serem publicados. Atividade suspeita √© reportada automaticamente.
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- LOGS -->
      <div class="dash-subpage" id="dash-logs">
        <div class="dash-header">
          <h1 class="dash-title">Meus Logs</h1>
        </div>
        <div class="table-wrap">
          <div class="table-header">
            <span class="table-title">Hist√≥rico de Atividade</span>
          </div>
          <table>
            <thead>
              <tr>
                <th>Evento</th>
                <th>IP</th>
                <th>Status</th>
                <th>Data/Hora</th>
                <th>User Agent</th>
              </tr>
            </thead>
            <tbody id="user-logs-table">
            </tbody>
          </table>
        </div>
      </div>

      <!-- API KEYS -->
      <div class="dash-subpage" id="dash-apikeys">
        <div class="dash-header">
          <h1 class="dash-title">Chaves API</h1>
          <button class="btn btn-primary" onclick="generateApiKey()">+ Gerar Nova Chave</button>
        </div>
        <div id="api-keys-list">
          <!-- Keys rendered here -->
        </div>
        <div class="dash-card" style="margin-top:16px">
          <div class="dash-card-label">üìñ Como usar</div>
          <div style="font-size:13px;color:var(--text-muted);line-height:1.7;margin-top:8px">
            Adicione o header <code style="background:var(--surface2);padding:2px 6px;border-radius:4px;color:var(--accent)">X-API-Key: sua-chave</code> nas requisi√ß√µes para acessar scripts protegidos. Nunca compartilhe suas chaves publicamente.
          </div>
        </div>
      </div>

      <!-- PROFILE -->
      <div class="dash-subpage" id="dash-profile">
        <div class="dash-header">
          <h1 class="dash-title">Perfil</h1>
        </div>
        <div class="profile-header">
          <div class="profile-avatar" id="profile-avatar"></div>
          <div class="profile-info">
            <h2 id="profile-name"></h2>
            <p id="profile-email"></p>
            <div style="margin-top:8px;display:flex;gap:8px">
              <span class="badge badge-green">Conta Ativa</span>
              <span class="badge badge-purple" id="profile-role"></span>
            </div>
          </div>
        </div>
        <div class="dash-card">
          <div class="table-title" style="margin-bottom:20px">Alterar Senha</div>
          <div class="form-group">
            <label class="form-label">SENHA ATUAL</label>
            <input type="password" class="form-input" id="current-pass">
          </div>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">NOVA SENHA</label>
              <input type="password" class="form-input" id="new-pass">
            </div>
            <div class="form-group">
              <label class="form-label">CONFIRMAR</label>
              <input type="password" class="form-input" id="confirm-pass">
            </div>
          </div>
          <button class="btn btn-primary" onclick="changePassword()">Salvar Senha</button>
        </div>
      </div>

      <!-- ADMIN -->
      <div class="dash-subpage" id="dash-admin">
        <div class="dash-header">
          <h1 class="dash-title">Admin Panel <span class="admin-badge">RESTRITO</span></h1>
        </div>

        <div class="dash-grid" style="grid-template-columns: repeat(4,1fr); margin-bottom: 24px;">
          <div class="dash-card">
            <div class="dash-card-label">üë• Usu√°rios</div>
            <div class="dash-card-value" id="admin-users">0</div>
          </div>
          <div class="dash-card">
            <div class="dash-card-label">üìÇ Scripts</div>
            <div class="dash-card-value" id="admin-scripts">0</div>
          </div>
          <div class="dash-card">
            <div class="dash-card-label">üö´ Banidos</div>
            <div class="dash-card-value" id="admin-banned">0</div>
          </div>
          <div class="dash-card">
            <div class="dash-card-label">‚ö†Ô∏è Tentativas Inv√°lidas</div>
            <div class="dash-card-value" id="admin-failed">0</div>
          </div>
        </div>

        <div class="tabs">
          <button class="tab active" onclick="switchAdminTab(this,'admin-tab-users')">üë• Usu√°rios</button>
          <button class="tab" onclick="switchAdminTab(this,'admin-tab-scripts')">üìÇ Scripts</button>
          <button class="tab" onclick="switchAdminTab(this,'admin-tab-logs')">üìã Logs</button>
          <button class="tab" onclick="switchAdminTab(this,'admin-tab-ips')">üåê IPs</button>
          <button class="tab" onclick="switchAdminTab(this,'admin-tab-settings')">‚öôÔ∏è Config</button>
        </div>

        <!-- Users Tab -->
        <div id="admin-tab-users">
          <div class="table-wrap">
            <div class="table-header">
              <span class="table-title">Todos os Usu√°rios</span>
              <input type="text" class="search-input" style="width:220px;padding:8px 12px" placeholder="Buscar usu√°rio..." id="admin-user-search" oninput="renderAdminUsers()">
            </div>
            <table>
              <thead>
                <tr>
                  <th>ID</th><th>Username</th><th>Email</th><th>IP</th><th>Status</th><th>Scripts</th><th>A√ß√µes</th>
                </tr>
              </thead>
              <tbody id="admin-users-table"></tbody>
            </table>
          </div>
        </div>

        <!-- Scripts Tab -->
        <div id="admin-tab-scripts" style="display:none">
          <div class="table-wrap">
            <div class="table-header">
              <span class="table-title">Todos os Scripts</span>
            </div>
            <table>
              <thead>
                <tr><th>ID</th><th>Nome</th><th>Autor</th><th>Visibilidade</th><th>Downloads</th><th>A√ß√µes</th></tr>
              </thead>
              <tbody id="admin-scripts-table"></tbody>
            </table>
          </div>
        </div>

        <!-- Logs Tab -->
        <div id="admin-tab-logs" style="display:none">
          <div class="table-wrap">
            <div class="table-header">
              <span class="table-title">Logs Completos do Sistema</span>
            </div>
            <table>
              <thead>
                <tr><th>Evento</th><th>Usu√°rio</th><th>IP</th><th>Status</th><th>Data</th></tr>
              </thead>
              <tbody id="admin-logs-table"></tbody>
            </table>
          </div>
        </div>

        <!-- IPs Tab -->
        <div id="admin-tab-ips" style="display:none">
          <div class="table-wrap">
            <div class="table-header">
              <span class="table-title">Controle de IP</span>
              <div style="display:flex;gap:8px;align-items:center">
                <input type="text" class="search-input" style="width:180px;padding:8px 12px" placeholder="IP para bloquear..." id="block-ip-input">
                <button class="btn btn-danger btn-sm" onclick="blockIP()">Bloquear IP</button>
              </div>
            </div>
            <table>
              <thead>
                <tr><th>IP</th><th>Pa√≠s</th><th>Tentativas</th><th>Status</th><th>A√ß√µes</th></tr>
              </thead>
              <tbody id="admin-ips-table"></tbody>
            </table>
          </div>
        </div>

        <!-- Settings Tab -->
        <div id="admin-tab-settings" style="display:none">
          <div class="dash-card" style="margin-bottom:16px">
            <div class="table-title" style="margin-bottom:20px">‚öôÔ∏è Configura√ß√µes do Sistema</div>
            <div style="display:flex;flex-direction:column;gap:16px">
              <div style="display:flex;align-items:center;justify-content:space-between;padding:14px;background:var(--surface2);border-radius:10px;border:1px solid var(--border)">
                <div>
                  <div style="font-size:14px;font-weight:600">Modo Manuten√ß√£o</div>
                  <div style="font-size:12px;color:var(--text-muted);margin-top:2px">Bloqueia acesso p√∫blico ao site</div>
                </div>
                <label style="display:flex;align-items:center;gap:8px;cursor:pointer">
                  <input type="checkbox" id="maintenance-toggle" onchange="toggleMaintenance()">
                  <span style="font-size:12px;color:var(--text-muted)" id="maintenance-status">Desligado</span>
                </label>
              </div>
              <div style="display:flex;align-items:center;justify-content:space-between;padding:14px;background:var(--surface2);border-radius:10px;border:1px solid var(--border)">
                <div>
                  <div style="font-size:14px;font-weight:600">Registro de Novos Usu√°rios</div>
                  <div style="font-size:12px;color:var(--text-muted);margin-top:2px">Permite cria√ß√£o de novas contas</div>
                </div>
                <label style="display:flex;align-items:center;gap:8px;cursor:pointer">
                  <input type="checkbox" id="registration-toggle" checked onchange="toggleRegistration()">
                  <span style="font-size:12px;color:var(--text-muted)" id="registration-status">Ativado</span>
                </label>
              </div>
              <div style="display:flex;align-items:center;justify-content:space-between;padding:14px;background:var(--surface2);border-radius:10px;border:1px solid var(--border)">
                <div>
                  <div style="font-size:14px;font-weight:600">Rate Limit Global</div>
                  <div style="font-size:12px;color:var(--text-muted);margin-top:2px">Requisi√ß√µes por IP por minuto</div>
                </div>
                <input type="number" value="60" class="form-input" style="width:80px;text-align:center">
              </div>
            </div>
          </div>
          <div class="dash-card">
            <div class="table-title" style="margin-bottom:16px">üö´ Blacklist Global</div>
            <div class="form-row">
              <div class="form-group">
                <label class="form-label">ADICIONAR AO BLACKLIST</label>
                <input type="text" class="form-input" placeholder="Username ou email..." id="blacklist-input">
              </div>
              <div class="form-group" style="display:flex;align-items:flex-end">
                <button class="btn btn-danger" style="width:100%" onclick="addToBlacklist()">Adicionar ao Blacklist</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
</div>

<!-- ============ MODALS ============ -->

<!-- LOGIN MODAL -->
<div class="modal-overlay" id="modal-login">
  <div class="modal">
    <button class="modal-close" onclick="closeModal('login')">√ó</button>
    <div class="modal-title">Entrar üëã</div>
    <div class="modal-sub">Bem-vindo de volta √† KitK4t Host</div>
    <div class="alert" id="login-alert"></div>
    <div class="form-group">
      <label class="form-label">EMAIL</label>
      <input type="email" class="form-input" placeholder="seu@email.com" id="login-email">
    </div>
    <div class="form-group">
      <label class="form-label">SENHA</label>
      <input type="password" class="form-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" id="login-password">
    </div>
    <button class="btn btn-primary form-submit" onclick="doLogin()">Entrar</button>
    <div class="form-footer">
      <a onclick="switchModal('login','forgot')">Esqueci minha senha</a> ¬∑
      <a onclick="switchModal('login','register')">Criar conta</a>
    </div>
  </div>
</div>

<!-- REGISTER MODAL -->
<div class="modal-overlay" id="modal-register">
  <div class="modal">
    <button class="modal-close" onclick="closeModal('register')">√ó</button>
    <div class="modal-title">Criar Conta ‚ö°</div>
    <div class="modal-sub">100% gratuito, para sempre</div>
    <div class="alert" id="register-alert"></div>
    <div class="form-group">
      <label class="form-label">USERNAME</label>
      <input type="text" class="form-input" placeholder="meuusuario" id="reg-username" oninput="this.value=this.value.replace(/[^a-zA-Z0-9_]/g,'')">
    </div>
    <div class="form-group">
      <label class="form-label">EMAIL</label>
      <input type="email" class="form-input" placeholder="seu@email.com" id="reg-email">
    </div>
    <div class="form-row">
      <div class="form-group">
        <label class="form-label">SENHA</label>
        <input type="password" class="form-input" placeholder="m√≠n. 8 chars" id="reg-password">
      </div>
      <div class="form-group">
        <label class="form-label">CONFIRMAR</label>
        <input type="password" class="form-input" placeholder="repita a senha" id="reg-confirm">
      </div>
    </div>
    <button class="btn btn-primary form-submit" onclick="doRegister()">Criar Conta Gr√°tis</button>
    <div class="form-footer">
      J√° tem conta? <a onclick="switchModal('register','login')">Entrar</a>
    </div>
  </div>
</div>

<!-- FORGOT PASSWORD MODAL -->
<div class="modal-overlay" id="modal-forgot">
  <div class="modal">
    <button class="modal-close" onclick="closeModal('forgot')">√ó</button>
    <div class="modal-title">Recuperar Senha üîê</div>
    <div class="modal-sub">Enviaremos um link de redefini√ß√£o</div>
    <div class="alert" id="forgot-alert"></div>
    <div class="form-group">
      <label class="form-label">SEU EMAIL</label>
      <input type="email" class="form-input" placeholder="seu@email.com" id="forgot-email">
    </div>
    <button class="btn btn-primary form-submit" onclick="doForgotPassword()">Enviar Link</button>
    <div class="form-footer">
      <a onclick="switchModal('forgot','login')">Voltar ao login</a>
    </div>
  </div>
</div>

<script>
// ============ STATE ============
const ADMIN_EMAIL = 'naotemsuporte@gmail.com';

let state = {
  user: null,
  users: JSON.parse(localStorage.getItem('lh_users') || '[]'),
  scripts: JSON.parse(localStorage.getItem('lh_scripts') || '[]'),
  logs: JSON.parse(localStorage.getItem('lh_logs') || '[]'),
  apiKeys: JSON.parse(localStorage.getItem('lh_apikeys') || '[]'),
  blockedIPs: JSON.parse(localStorage.getItem('lh_blocked_ips') || '[]'),
  blacklist: JSON.parse(localStorage.getItem('lh_blacklist') || '[]'),
  maintenance: JSON.parse(localStorage.getItem('lh_maintenance') || 'false'),
  registrationOpen: JSON.parse(localStorage.getItem('lh_registration') !== null ? localStorage.getItem('lh_registration') : 'true'),
};

// Seed demo data if empty
if (state.scripts.length === 0) {
  state.scripts = [
    { id: uid(), name: 'Auto Farm Pro', author: 'ScriptMaster', desc: 'Script de auto farm completo com suporte a m√∫ltiplos jogos.', category: 'game', visibility: 'public', code: '-- Auto Farm Pro\nlocal Players = game:GetService("Players")\nprint("Auto Farm ativado!")', downloads: 1284, version: '2.1.0', date: '2024-11-10', keyProtected: false, userId: null },
    { id: uid(), name: 'GUI Library v3', author: 'DevUI', desc: 'Biblioteca de UI moderna para scripts Roblox com tema escuro.', category: 'ui', visibility: 'public', code: '-- GUI Library v3\nlocal lib = {}\nreturn lib', downloads: 879, version: '3.0.2', date: '2024-11-08', keyProtected: false, userId: null },
    { id: uid(), name: 'Admin Painel', author: 'AdminDev', desc: 'Painel administrativo completo para seus jogos Roblox.', category: 'admin', visibility: 'public', code: '-- Admin Panel\nlocal admins = {}', downloads: 542, version: '1.5.0', date: '2024-11-05', keyProtected: false, userId: null },
    { id: uid(), name: 'Data Store Helper', author: 'DataWizard', desc: 'Utilit√°rio para gerenciamento f√°cil de DataStores.', category: 'utility', visibility: 'public', code: '-- DataStore Helper\nlocal ds = game:GetService("DataStoreService")', downloads: 321, version: '1.2.0', date: '2024-11-01', keyProtected: false, userId: null },
  ];
  save();
}

function save() {
  localStorage.setItem('lh_users', JSON.stringify(state.users));
  localStorage.setItem('lh_scripts', JSON.stringify(state.scripts));
  localStorage.setItem('lh_logs', JSON.stringify(state.logs));
  localStorage.setItem('lh_apikeys', JSON.stringify(state.apiKeys));
  localStorage.setItem('lh_blocked_ips', JSON.stringify(state.blockedIPs));
  localStorage.setItem('lh_blacklist', JSON.stringify(state.blacklist));
  localStorage.setItem('lh_maintenance', JSON.stringify(state.maintenance));
  localStorage.setItem('lh_registration', JSON.stringify(state.registrationOpen));
}

function uid() {
  return Math.random().toString(36).slice(2, 10).toUpperCase();
}

function now() {
  return new Date().toLocaleString('pt-BR');
}

function getIP() {
  return '177.' + Math.floor(Math.random()*255) + '.' + Math.floor(Math.random()*255) + '.' + Math.floor(Math.random()*255);
}

function addLog(type, userId, username, email, ip, status, extra) {
  const log = { id: uid(), type, userId, username, email, ip: ip || getIP(), status, date: now(), ua: navigator.userAgent.slice(0,60), extra };
  state.logs.unshift(log);
  if (state.logs.length > 500) state.logs = state.logs.slice(0, 500);
  save();

  // Send to Discord webhooks (simulated in demo - actual webhooks in backend)
  sendDiscordWebhook(type, log);
}

async function sendDiscordWebhook(type, log) {
  // In production, these are sent from the backend.
  // Frontend demo simulates the call.
  const WEBHOOKS = {
    register: 'https://discord.com/api/webhooks/1473381835454025819/LMveeSMzMYoJF4WLeo_6EErq9J-E2JIzOqw5_mli1_MPhPTHAlzIyPfGshJq33-TQMy7',
    login: 'https://discord.com/api/webhooks/1473381919277318336/tVswu-10xRlQhG5XMWdADkV0VjFdyIP6Rdsd2q9_met9GOLLEuuR3-D8MeRVEI2GRbWw',
  };

  if (!WEBHOOKS[type]) return;

  const color = log.status === 'success' ? 0x00d4aa : 0xff6b6b;
  const emoji = log.status === 'success' ? '‚úÖ' : '‚ùå';

  const embed = {
    embeds: [{
      title: `${emoji} KitK4t Host ‚Äî Novo Registro`' : 'Login'}`,
      color,
      fields: [
        { name: 'Username', value: log.username || 'N/A', inline: true },
        { name: 'Email', value: log.email || 'N/A', inline: true },
        { name: 'User ID', value: log.userId || 'N/A', inline: true },
        { name: 'IP', value: log.ip || 'N/A', inline: true },
        { name: 'Status', value: log.status, inline: true },
        { name: 'Data/Hora', value: log.date, inline: true },
        { name: 'User Agent', value: (log.ua || 'N/A').slice(0, 100) },
      ],
      footer: { text: 'KitK4t Host Security System' },
      timestamp: new Date().toISOString(),
    }]
  };

  try {
    await fetch(WEBHOOKS[type], {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(embed),
    });
  } catch(e) {
    // Silently fail ‚Äî cross-origin in demo
  }
}

// ============ NAVIGATION ============
function showPage(page) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.getElementById('page-' + page).classList.add('active');
  window.scrollTo(0, 0);
  if (page === 'scripts') renderPublicScripts();
  if (page === 'dashboard') {
    updateDashboardUI();
    showDashPage('overview');
  }
}

function showDashPage(page) {
  document.querySelectorAll('.dash-subpage').forEach(p => p.classList.remove('active'));
  const el = document.getElementById('dash-' + page);
  if (el) el.classList.add('active');

  document.querySelectorAll('.sidebar-link').forEach(l => l.classList.remove('active'));
  const slink = document.getElementById('slink-' + page);
  if (slink) slink.classList.add('active');

  if (!state.user) { showPage('home'); openModal('login'); return; }

  showPage('dashboard');

  if (page === 'scripts') renderMyScripts();
  if (page === 'logs') renderUserLogs();
  if (page === 'apikeys') renderApiKeys();
  if (page === 'profile') renderProfile();
  if (page === 'admin') {
    if (!isAdmin()) { toast('Acesso negado', 'error'); return; }
    renderAdmin();
  }
}

function scrollToFeatures() {
  setTimeout(() => document.getElementById('features').scrollIntoView({ behavior: 'smooth' }), 100);
}

// ============ AUTH ============
function isAdmin() {
  return state.user && state.user.email === ADMIN_EMAIL;
}

function hashPassword(pass) {
  // Simulated hash for demo ‚Äî use bcrypt on backend
  let hash = 0;
  for (let i = 0; i < pass.length; i++) { hash = ((hash << 5) - hash) + pass.charCodeAt(i); hash |= 0; }
  return 'hashed_' + Math.abs(hash).toString(16) + '_' + pass.length;
}

function doRegister() {
  const username = document.getElementById('reg-username').value.trim();
  const email = document.getElementById('reg-email').value.trim().toLowerCase();
  const password = document.getElementById('reg-password').value;
  const confirm = document.getElementById('reg-confirm').value;

  // Validation
  if (!username || username.length < 3) return showAlert('register', 'Username deve ter pelo menos 3 caracteres');
  if (!/^[a-zA-Z0-9_]+$/.test(username)) return showAlert('register', 'Username s√≥ pode conter letras, n√∫meros e _');
  if (!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) return showAlert('register', 'Email inv√°lido');
  if (password.length < 8) return showAlert('register', 'Senha deve ter pelo menos 8 caracteres');
  if (password !== confirm) return showAlert('register', 'Senhas n√£o coincidem');
  if (!state.registrationOpen) return showAlert('register', 'Registro de novas contas est√° desabilitado');

  // Check existing
  if (state.users.find(u => u.email === email)) return showAlert('register', 'Este email j√° est√° cadastrado');
  if (state.users.find(u => u.username.toLowerCase() === username.toLowerCase())) return showAlert('register', 'Este username j√° est√° em uso');
  if (state.blacklist.includes(email) || state.blacklist.includes(username.toLowerCase())) return showAlert('register', 'Conta n√£o permitida');

  const ip = getIP();
  const user = {
    id: uid(),
    username,
    email,
    password: hashPassword(password),
    role: email === ADMIN_EMAIL ? 'admin' : 'user',
    banned: false,
    ip,
    createdAt: now(),
    lastLogin: now(),
  };

  state.users.push(user);
  addLog('register', user.id, username, email, ip, 'success');
  save();

  toast('Conta criada com sucesso! Bem-vindo(a)!', 'success');
  closeModal('register');
  loginUser(user);
}

function doLogin() {
  const email = document.getElementById('login-email').value.trim().toLowerCase();
  const password = document.getElementById('login-password').value;

  if (!email || !password) return showAlert('login', 'Preencha todos os campos');

  const ip = getIP();
  const user = state.users.find(u => u.email === email);

  if (!user) {
    addLog('login', null, 'unknown', email, ip, 'failed - user not found');
    return showAlert('login', 'Email ou senha incorretos');
  }

  if (user.banned) {
    addLog('login', user.id, user.username, email, ip, 'failed - banned');
    return showAlert('login', 'Sua conta foi banida. Entre em contato com o suporte.');
  }

  if (user.password !== hashPassword(password)) {
    addLog('login', user.id, user.username, email, ip, 'failed - wrong password');
    return showAlert('login', 'Email ou senha incorretos');
  }

  user.lastLogin = now();
  user.ip = ip;
  addLog('login', user.id, user.username, email, ip, 'success');
  save();

  closeModal('login');
  toast('Bem-vindo de volta, ' + user.username + '!', 'success');
  loginUser(user);
}

function doForgotPassword() {
  const email = document.getElementById('forgot-email').value.trim().toLowerCase();
  if (!email) return showAlert('forgot', 'Digite seu email');
  const user = state.users.find(u => u.email === email);
  if (!user) return showAlert('forgot', 'Email n√£o encontrado', false);
  showAlert('forgot', '‚úÖ Link de recupera√ß√£o enviado para ' + email, true);
  toast('Email de recupera√ß√£o enviado!', 'success');
}

function loginUser(user) {
  state.user = user;
  localStorage.setItem('lh_session', JSON.stringify({ id: user.id, token: uid() + uid() }));
  updateNav();
  showPage('dashboard');
}

function logout() {
  state.user = null;
  localStorage.removeItem('lh_session');
  updateNav();
  showPage('home');
  toast('Sess√£o encerrada', 'success');
}

function checkSession() {
  const session = JSON.parse(localStorage.getItem('lh_session') || 'null');
  if (session) {
    const user = state.users.find(u => u.id === session.id);
    if (user && !user.banned) {
      state.user = user;
      updateNav();
    }
  }
}

function updateNav() {
  const isLoggedIn = !!state.user;
  document.getElementById('nav-links-public').style.display = isLoggedIn ? 'none' : 'flex';
  document.getElementById('nav-links-auth').style.display = isLoggedIn ? 'flex' : 'none';
  document.getElementById('nav-cta-public').style.display = isLoggedIn ? 'none' : 'flex';
  document.getElementById('nav-cta-auth').style.display = isLoggedIn ? 'flex' : 'none';
  if (isLoggedIn) {
    document.getElementById('nav-username').textContent = state.user.username;
    document.getElementById('admin-nav-link').style.display = isAdmin() ? 'block' : 'none';
  }
}

function updateDashboardUI() {
  if (!state.user) return;
  document.getElementById('dash-username').textContent = state.user.username;
  document.getElementById('admin-sidebar-section').style.display = isAdmin() ? 'block' : 'none';

  const myScripts = state.scripts.filter(s => s.userId === state.user.id);
  const myKeys = state.apiKeys.filter(k => k.userId === state.user.id);
  document.getElementById('my-script-count').textContent = myScripts.length;
  document.getElementById('my-downloads').textContent = myScripts.reduce((s, x) => s + (x.downloads||0), 0);
  document.getElementById('my-keys').textContent = myKeys.length;
}

// ============ MODALS ============
function openModal(name) {
  document.getElementById('modal-' + name).classList.add('active');
}

function closeModal(name) {
  document.getElementById('modal-' + name).classList.remove('active');
  clearAlerts();
}

function switchModal(from, to) {
  closeModal(from);
  openModal(to);
}

function clearAlerts() {
  document.querySelectorAll('.alert').forEach(a => { a.classList.remove('active'); a.textContent = ''; });
}

function showAlert(modal, msg, isSuccess = false) {
  const el = document.getElementById(modal + '-alert');
  if (el) {
    el.textContent = msg;
    el.className = 'alert' + (isSuccess ? ' success' : ' error') + ' active';
  }
}

// Close modal on overlay click
document.querySelectorAll('.modal-overlay').forEach(overlay => {
  overlay.addEventListener('click', e => {
    if (e.target === overlay) {
      overlay.classList.remove('active');
    }
  });
});

// ============ SCRIPTS ============
function renderPublicScripts() {
  const grid = document.getElementById('public-scripts-grid');
  const search = (document.getElementById('script-search')?.value || '').toLowerCase();
  const filter = document.getElementById('script-filter')?.value || 'all';
  const publicScripts = state.scripts.filter(s =>
    s.visibility === 'public' &&
    (filter === 'all' || s.category === filter) &&
    (s.name.toLowerCase().includes(search) || s.desc.toLowerCase().includes(search))
  );

  grid.innerHTML = publicScripts.map(s => `
    <div class="script-card">
      <div class="script-card-header">
        <div>
          <div class="script-name">${escHtml(s.name)}</div>
          <div class="script-author">por @${escHtml(s.author)}</div>
        </div>
        <span class="badge badge-purple">${s.category}</span>
      </div>
      <p class="script-desc">${escHtml(s.desc)}</p>
      <div class="script-footer">
        <div class="script-meta">
          <span class="script-meta-item">‚¨áÔ∏è ${s.downloads}</span>
          <span class="script-meta-item">üè∑Ô∏è v${s.version}</span>
          <span class="script-meta-item">üìÖ ${s.date}</span>
        </div>
        ${s.keyProtected
          ? '<span class="badge badge-red">üîë Protegido</span>'
          : `<button class="btn btn-success btn-sm" onclick="downloadScript('${s.id}')">Obter</button>`
        }
      </div>
    </div>
  `).join('') || '<div style="text-align:center;color:var(--text-dim);padding:60px;grid-column:1/-1">Nenhum script encontrado</div>';
}

function filterScripts() {
  renderPublicScripts();
}

function downloadScript(id) {
  const s = state.scripts.find(x => x.id === id);
  if (!s) return;
  s.downloads = (s.downloads || 0) + 1;
  save();
  const blob = new Blob([s.code], { type: 'text/plain' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = s.name.replace(/\s/g,'_') + '.luau';
  a.click();
  toast('Script baixado: ' + s.name, 'success');
  renderPublicScripts();
}

function renderMyScripts() {
  if (!state.user) return;
  const myScripts = state.scripts.filter(s => s.userId === state.user.id);
  const tbody = document.getElementById('my-scripts-table');
  tbody.innerHTML = myScripts.length === 0
    ? `<tr><td colspan="6" style="text-align:center;color:var(--text-dim);padding:32px">Nenhum script ainda. <a href="#" onclick="showDashPage('upload')" style="color:var(--accent)">Fa√ßa upload agora</a></td></tr>`
    : myScripts.map(s => `
      <tr>
        <td style="color:var(--text)">${escHtml(s.name)}</td>
        <td><span class="badge ${s.visibility==='public'?'badge-green':'badge-gray'}">${s.visibility==='public'?'P√∫blico':'Privado'}</span></td>
        <td>v${s.version}</td>
        <td>${s.downloads || 0}</td>
        <td>${s.date}</td>
        <td>
          <div style="display:flex;gap:6px">
            <button class="btn btn-ghost btn-sm" onclick="editScript('${s.id}')">Editar</button>
            <button class="btn btn-danger btn-sm" onclick="deleteScript('${s.id}')">Excluir</button>
          </div>
        </td>
      </tr>
    `).join('');
}

function uploadScript() {
  if (!state.user) return openModal('login');
  const name = document.getElementById('upload-name').value.trim();
  const desc = document.getElementById('upload-desc').value.trim();
  const code = document.getElementById('code-editor').value.trim();
  const category = document.getElementById('upload-cat').value;
  const visibility = document.getElementById('upload-visibility').value;
  const keyProtected = document.getElementById('upload-key-protect').value === 'yes';

  if (!name) return toast('Digite um nome para o script', 'error');
  if (!code) return toast('O editor est√° vazio', 'error');
  if (code.length > 1024 * 1024) return toast('Script muito grande (m√°x. 1MB)', 'error');

  // Basic blacklist check
  const badWords = ['malware', 'hack', 'exploit', 'bypass'];
  const codeLower = code.toLowerCase();
  if (badWords.some(w => codeLower.includes(w) && w === 'malware')) {
    toast('Script bloqueado: conte√∫do detectado na blacklist', 'error');
    addLog('upload_blocked', state.user.id, state.user.username, state.user.email, state.user.ip, 'blocked');
    return;
  }

  const script = {
    id: uid(),
    name, desc, code, category, visibility,
    keyProtected,
    author: state.user.username,
    userId: state.user.id,
    version: '1.0.0',
    downloads: 0,
    date: new Date().toLocaleDateString('pt-BR'),
  };

  state.scripts.unshift(script);
  addLog('upload', state.user.id, state.user.username, state.user.email, state.user.ip, 'success', name);
  save();

  toast('Script "' + name + '" publicado com sucesso!', 'success');
  document.getElementById('upload-name').value = '';
  document.getElementById('upload-desc').value = '';
  document.getElementById('code-editor').value = '';
  showDashPage('scripts');
}

function editScript(id) {
  const s = state.scripts.find(x => x.id === id);
  if (!s) return;
  showDashPage('upload');
  document.getElementById('upload-name').value = s.name;
  document.getElementById('upload-desc').value = s.desc;
  document.getElementById('code-editor').value = s.code;
  document.getElementById('upload-cat').value = s.category;
  document.getElementById('upload-visibility').value = s.visibility;
  document.getElementById('editor-filename').textContent = s.name + '.luau';
  toast('Editando: ' + s.name, 'success');
}

function deleteScript(id) {
  if (!confirm('Tem certeza que deseja excluir este script?')) return;
  const idx = state.scripts.findIndex(s => s.id === id);
  if (idx === -1) return;
  const s = state.scripts[idx];
  state.scripts.splice(idx, 1);
  addLog('delete_script', state.user.id, state.user.username, state.user.email, state.user.ip, 'success', s.name);
  save();
  renderMyScripts();
  toast('Script exclu√≠do', 'success');
}

function clearEditor() {
  document.getElementById('code-editor').value = '';
}

function formatCode() {
  const editor = document.getElementById('code-editor');
  let code = editor.value;
  // Basic indent normalization
  code = code.split('\n').map(l => l.trimEnd()).join('\n');
  editor.value = code;
  toast('C√≥digo formatado', 'success');
}

// ============ API KEYS ============
function generateApiKey() {
  if (!state.user) return;
  const key = 'lhk_' + uid() + uid() + uid();
  const apiKey = {
    id: uid(),
    key,
    userId: state.user.id,
    label: 'Chave ' + (state.apiKeys.filter(k => k.userId === state.user.id).length + 1),
    createdAt: now(),
    active: true,
  };
  state.apiKeys.push(apiKey);
  save();
  renderApiKeys();
  toast('Nova chave API gerada!', 'success');
}

function revokeApiKey(id) {
  const k = state.apiKeys.find(x => x.id === id);
  if (k) { k.active = false; save(); renderApiKeys(); toast('Chave revogada', 'success'); }
}

function renderApiKeys() {
  const list = document.getElementById('api-keys-list');
  const myKeys = state.apiKeys.filter(k => k.userId === state.user.id);
  list.innerHTML = myKeys.length === 0
    ? '<div class="dash-card" style="text-align:center;color:var(--text-dim)">Nenhuma chave ainda. Clique em "+ Gerar Nova Chave"</div>'
    : myKeys.map(k => `
      <div class="dash-card" style="margin-bottom:12px">
        <div style="display:flex;align-items:center;justify-content:space-between">
          <div>
            <div style="font-size:14px;font-weight:600">${escHtml(k.label)}</div>
            <div style="font-size:12px;color:var(--text-muted);margin-top:2px">Criada em ${k.createdAt}</div>
          </div>
          <span class="badge ${k.active ? 'badge-green' : 'badge-red'}">${k.active ? 'Ativa' : 'Revogada'}</span>
        </div>
        <div class="api-key-display">
          <span>${k.active ? k.key : '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢'}</span>
          ${k.active ? `<button class="copy-btn" onclick="copyText('${k.key}')">üìã</button>` : ''}
        </div>
        ${k.active ? `<div style="margin-top:10px"><button class="btn btn-danger btn-sm" onclick="revokeApiKey('${k.id}')">Revogar</button></div>` : ''}
      </div>
    `).join('');
}

// ============ LOGS ============
function renderUserLogs() {
  if (!state.user) return;
  const myLogs = state.logs.filter(l => l.userId === state.user.id);
  const tbody = document.getElementById('user-logs-table');
  tbody.innerHTML = myLogs.length === 0
    ? '<tr><td colspan="5" style="text-align:center;color:var(--text-dim);padding:32px">Nenhum log ainda</td></tr>'
    : myLogs.map(l => `
      <tr>
        <td><span class="badge ${getLogBadge(l.type)}">${l.type}</span></td>
        <td style="font-size:12px">${l.ip}</td>
        <td><span class="badge ${l.status.startsWith('success') ? 'badge-green' : 'badge-red'}">${l.status}</span></td>
        <td style="font-size:12px">${l.date}</td>
        <td style="font-size:11px;color:var(--text-dim)">${l.ua ? l.ua.slice(0,50)+'...' : 'N/A'}</td>
      </tr>
    `).join('');
}

function getLogBadge(type) {
  if (type === 'login') return 'badge-purple';
  if (type === 'register') return 'badge-green';
  if (type === 'upload') return 'badge-blue' ;
  return 'badge-gray';
}

// ============ PROFILE ============
function renderProfile() {
  if (!state.user) return;
  document.getElementById('profile-avatar').textContent = state.user.username[0].toUpperCase();
  document.getElementById('profile-name').textContent = state.user.username;
  document.getElementById('profile-email').textContent = state.user.email;
  document.getElementById('profile-role').textContent = isAdmin() ? 'Admin' : 'Usu√°rio';
}

function changePassword() {
  const cur = document.getElementById('current-pass').value;
  const nw = document.getElementById('new-pass').value;
  const conf = document.getElementById('confirm-pass').value;
  if (!cur || !nw || !conf) return toast('Preencha todos os campos', 'error');
  if (state.user.password !== hashPassword(cur)) return toast('Senha atual incorreta', 'error');
  if (nw.length < 8) return toast('Nova senha muito curta (m√≠n. 8 chars)', 'error');
  if (nw !== conf) return toast('Senhas n√£o coincidem', 'error');
  const user = state.users.find(u => u.id === state.user.id);
  if (user) { user.password = hashPassword(nw); state.user.password = user.password; }
  save();
  toast('Senha alterada com sucesso!', 'success');
  ['current-pass', 'new-pass', 'confirm-pass'].forEach(id => document.getElementById(id).value = '');
}

// ============ ADMIN ============
function renderAdmin() {
  const userCount = state.users.length;
  const scriptCount = state.scripts.length;
  const banned = state.users.filter(u => u.banned).length;
  const failed = state.logs.filter(l => l.status.startsWith('failed')).length;

  document.getElementById('admin-users').textContent = userCount;
  document.getElementById('admin-scripts').textContent = scriptCount;
  document.getElementById('admin-banned').textContent = banned;
  document.getElementById('admin-failed').textContent = failed;

  renderAdminUsers();
  renderAdminScripts();
  renderAdminLogs();
  renderAdminIPs();
}

function renderAdminUsers() {
  const search = (document.getElementById('admin-user-search')?.value || '').toLowerCase();
  const filtered = state.users.filter(u =>
    u.username.toLowerCase().includes(search) || u.email.toLowerCase().includes(search)
  );
  const tbody = document.getElementById('admin-users-table');
  if (!tbody) return;
  tbody.innerHTML = filtered.length === 0
    ? '<tr><td colspan="7" style="text-align:center;padding:32px;color:var(--text-dim)">Nenhum usu√°rio</td></tr>'
    : filtered.map(u => `
      <tr>
        <td style="font-family:var(--font-mono);font-size:11px;color:var(--text-dim)">${u.id}</td>
        <td style="color:var(--text);font-weight:600">${escHtml(u.username)}</td>
        <td>${escHtml(u.email)}</td>
        <td style="font-size:12px">${u.ip || 'N/A'}</td>
        <td><span class="badge ${u.banned ? 'badge-red' : 'badge-green'}">${u.banned ? 'Banido' : 'Ativo'}</span>${u.email === ADMIN_EMAIL ? ' <span class="admin-badge">ADMIN</span>' : ''}</td>
        <td>${state.scripts.filter(s => s.userId === u.id).length}</td>
        <td>
          <button class="btn btn-${u.banned ? 'success' : 'danger'} btn-sm" onclick="toggleBan('${u.id}')">
            ${u.banned ? 'Desbanir' : 'Banir'}
          </button>
        </td>
      </tr>
    `).join('');
}

function renderAdminScripts() {
  const tbody = document.getElementById('admin-scripts-table');
  if (!tbody) return;
  tbody.innerHTML = state.scripts.map(s => `
    <tr>
      <td style="font-size:11px;color:var(--text-dim)">${s.id}</td>
      <td style="color:var(--text)">${escHtml(s.name)}</td>
      <td>${escHtml(s.author)}</td>
      <td><span class="badge ${s.visibility==='public'?'badge-green':'badge-gray'}">${s.visibility}</span></td>
      <td>${s.downloads || 0}</td>
      <td>
        <button class="btn btn-danger btn-sm" onclick="adminDeleteScript('${s.id}')">Excluir</button>
      </td>
    </tr>
  `).join('') || '<tr><td colspan="6" style="text-align:center;padding:32px;color:var(--text-dim)">Nenhum script</td></tr>';
}

function renderAdminLogs() {
  const tbody = document.getElementById('admin-logs-table');
  if (!tbody) return;
  tbody.innerHTML = state.logs.slice(0, 100).map(l => `
    <tr>
      <td><span class="badge ${getLogBadge(l.type)}">${l.type}</span></td>
      <td>${escHtml(l.username || 'N/A')}</td>
      <td style="font-size:12px">${l.ip}</td>
      <td><span class="badge ${l.status.startsWith('success') ? 'badge-green' : 'badge-red'}">${l.status}</span></td>
      <td style="font-size:12px">${l.date}</td>
    </tr>
  `).join('') || '<tr><td colspan="5" style="text-align:center;padding:32px;color:var(--text-dim)">Nenhum log</td></tr>';
}

function renderAdminIPs() {
  const tbody = document.getElementById('admin-ips-table');
  if (!tbody) return;

  // Aggregate IPs from logs
  const ipMap = {};
  state.logs.forEach(l => {
    if (!l.ip) return;
    if (!ipMap[l.ip]) ipMap[l.ip] = { ip: l.ip, attempts: 0, blocked: false };
    ipMap[l.ip].attempts++;
  });
  state.blockedIPs.forEach(ip => {
    if (!ipMap[ip]) ipMap[ip] = { ip, attempts: 0 };
    ipMap[ip].blocked = true;
  });

  const ips = Object.values(ipMap);
  tbody.innerHTML = ips.length === 0
    ? '<tr><td colspan="5" style="text-align:center;padding:32px;color:var(--text-dim)">Nenhuma atividade de IP</td></tr>'
    : ips.map(ip => `
      <tr>
        <td>${ip.ip}</td>
        <td>BR</td>
        <td>${ip.attempts}</td>
        <td><span class="badge ${ip.blocked ? 'badge-red' : 'badge-green'}">${ip.blocked ? 'Bloqueado' : 'Permitido'}</span></td>
        <td>
          ${ip.blocked
            ? `<button class="btn btn-success btn-sm" onclick="unblockIP('${ip.ip}')">Desbloquear</button>`
            : `<button class="btn btn-danger btn-sm" onclick="blockIPDirect('${ip.ip}')">Bloquear</button>`
          }
        </td>
      </tr>
    `).join('');
}

function toggleBan(userId) {
  if (!isAdmin()) return;
  const user = state.users.find(u => u.id === userId);
  if (!user) return;
  if (user.email === ADMIN_EMAIL) return toast('N√£o √© poss√≠vel banir o administrador', 'error');
  user.banned = !user.banned;
  save();
  renderAdminUsers();
  renderAdmin();
  toast(user.banned ? 'Usu√°rio banido: ' + user.username : 'Usu√°rio desbanido: ' + user.username, 'success');
}

function adminDeleteScript(id) {
  if (!confirm('Excluir este script?')) return;
  const idx = state.scripts.findIndex(s => s.id === id);
  if (idx !== -1) { state.scripts.splice(idx, 1); save(); renderAdmin(); toast('Script exclu√≠do pelo admin', 'success'); }
}

function blockIP() {
  const ip = document.getElementById('block-ip-input').value.trim();
  if (!ip) return;
  blockIPDirect(ip);
  document.getElementById('block-ip-input').value = '';
}

function blockIPDirect(ip) {
  if (!state.blockedIPs.includes(ip)) { state.blockedIPs.push(ip); save(); }
  renderAdminIPs();
  toast('IP bloqueado: ' + ip, 'success');
}

function unblockIP(ip) {
  state.blockedIPs = state.blockedIPs.filter(x => x !== ip);
  save();
  renderAdminIPs();
  toast('IP desbloqueado: ' + ip, 'success');
}

function switchAdminTab(btn, tabId) {
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  btn.classList.add('active');
  ['admin-tab-users','admin-tab-scripts','admin-tab-logs','admin-tab-ips','admin-tab-settings'].forEach(id => {
    document.getElementById(id).style.display = id === tabId ? 'block' : 'none';
  });
}

function toggleMaintenance() {
  state.maintenance = document.getElementById('maintenance-toggle').checked;
  document.getElementById('maintenance-status').textContent = state.maintenance ? 'Ligado' : 'Desligado';
  save();
  toast('Modo manuten√ß√£o: ' + (state.maintenance ? 'ATIVADO' : 'desativado'), state.maintenance ? 'error' : 'success');
}

function toggleRegistration() {
  state.registrationOpen = document.getElementById('registration-toggle').checked;
  document.getElementById('registration-status').textContent = state.registrationOpen ? 'Ativado' : 'Desativado';
  save();
  toast('Registro: ' + (state.registrationOpen ? 'ATIVADO' : 'desativado'), 'success');
}

function addToBlacklist() {
  const val = document.getElementById('blacklist-input').value.trim().toLowerCase();
  if (!val) return;
  if (!state.blacklist.includes(val)) { state.blacklist.push(val); save(); }
  document.getElementById('blacklist-input').value = '';
  toast('Adicionado ao blacklist: ' + val, 'success');
}

// ============ UTILITIES ============
function toast(msg, type = 'success') {
  const container = document.getElementById('toast-container');
  const t = document.createElement('div');
  t.className = 'toast ' + type;
  t.innerHTML = (type === 'success' ? '‚úÖ ' : '‚ùå ') + escHtml(msg);
  container.appendChild(t);
  setTimeout(() => { t.style.opacity = '0'; t.style.transition = 'opacity 0.3s'; setTimeout(() => t.remove(), 300); }, 3500);
}

function copyText(text) {
  navigator.clipboard.writeText(text).then(() => toast('Copiado para a √°rea de transfer√™ncia!', 'success'));
}

function escHtml(str) {
  if (!str) return '';
  return String(str).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
}

// Animate stats
function animateStats() {
  const targets = { 'stat-users': 1247, 'stat-scripts': 4891, 'stat-downloads': 38200 };
  Object.entries(targets).forEach(([id, target]) => {
    const el = document.getElementById(id);
    if (!el) return;
    let start = 0;
    const step = target / 60;
    const timer = setInterval(() => {
      start += step;
      if (start >= target) { el.textContent = target >= 1000 ? (target/1000).toFixed(1) + 'k' : target; clearInterval(timer); }
      else { el.textContent = Math.floor(start) >= 1000 ? (Math.floor(start)/1000).toFixed(1) + 'k' : Math.floor(start); }
    }, 16);
  });
}

// Enter key on forms
document.addEventListener('keydown', e => {
  if (e.key === 'Enter') {
    if (document.getElementById('modal-login').classList.contains('active')) doLogin();
    if (document.getElementById('modal-register').classList.contains('active')) doRegister();
  }
});

// ============ INIT ============
checkSession();
updateNav();
animateStats();
renderPublicScripts();

// Update stats from real data
document.getElementById('stat-users').textContent = Math.max(1247, state.users.length);
document.getElementById('stat-scripts').textContent = Math.max(4891, state.scripts.length);
</script>

</body>
</html>
